## **Чтобы настроить Playwright для разработки автотестов:**

### Установить Playwright с помощью менеджера пакетов pip:

`pip install playwright`

`playwright install`

### Установите Pytest:

`pip install pytest`

### Установите плагин Pytest:

`pip install pytest-playwright`

### Для запуска codegen откройте терминал (Pycharm, VScode), введите  приведенную ниже команду и нажмите Enter.

### `playwright codegen demo.playwright.dev/todomvc/#/`

### 2. Для того чтобы получить доступ ко всем функциям, методам и классам playwright, необходимо импортировать его в наш код, что делает приведенная строка кода ниже

`from playwright.sync_api import Playwright, sync_playwright, expect`

### Узнать доступные опции и краткое их описание можно, выполнив команду

`playwright codegen --help`

### При каждом обновлении Playwright вам, возможно придется заново запускать команду

`playwright install`

---------------------------------------------------------------
---------------------------------------------------------------

## Для таких же, как и я, которые не сразу поняли. У кого Pycharm

### Для запуска инспектора и вашего теста с вашим кодом:

1. В терминале pycharm пишем set PWDEBUG=1. Нажать ENTER

2.Запускаем тест, как обычно, я запускаю так: pytest --headed --slowmo 2000 test_dir\test_checkTaskCompleted.py

### Для запуска меню разработчика в браузере и инспектора:

1. В терминале pycharm пишем set PWDEBUG=console. Нажать ENTER

2.В коде добавить новую строчку page.pause() после той строчки, где вы хотите чтобы тест сделал остановку.

3.Запускаем тест, как обычно, я запускаю так: pytest --headed --slowmo 2000 test_dir\test_checkTaskCompleted.py

4.Нажать F12 , чтобы открыть меню разработчика. Далее смотри как написано в уроке. Всем добра!

см. https://playwright.dev/python/docs/debug

-----------------------------------------------------------------
-----------------------------------------------------------------

## Запись трассировки

Чтобы записать трассировку, вам необходимо с помощью CLI передать атрибут --tracing и выбрать вариант записи.

### Доступные варианты записи трассировки:

'on'- Запишет трассировку для каждого теста. (не рекомендуется, так как производительность тяжелая)
'retain-on-failure'- Запишет трассировку для каждого теста, но удалит ее из успешных тестовых прогонов.
Команда для запуска всех тестов и сохранением трассировки только неудачных

**Record trace for each test, but remove all traces from successful test runs:**

## pytest --tracing=retain-on-failure

**Record trace for each test:**

## pytest --tracing on

## off: - Do not record trace. (default)

После выполнения всех тестов должна появиться директория test-results с архивом trace.zip

### Просмотр трассировки

Для просмотра выполните команду playwright show-trace и укажите адрес с записанному архиву трассировки

## playwright show-trace trace.zip

-----------------------------------------------------------------
-----------------------------------------------------------------

1. Pytest - наиболее популярный фреймворк/tests runner
2. Pytest автоматически сканирует ваш код на наличие тестовых модулей, файлов, следующих соглашению об именовании:

       - Пакет/директория: "test*"
       - Файлы test_*.py или *_test.py
       - Классы Test*
       - функций test_*()

4. Pytest --headed
5. Файл conftest не обязательно создавать т.к Fixture вшиты (page, contex, browser)
6. CLI - Интерфейс командной строки (англ. Command Line Interface, CLI)
   Рассмотрим подробнее команды для управления playwright с помощью cli

**--headed** - playwright по умолчанию запускает браузеры в безголовом(headless) режиме.**
При использовании данного аргумента, запуск теста произойдет в режиме headed.

**--browser** - запускать тесты в другом браузере chromium, firefox или webkit. Может быть указано несколько раз (по
умолчанию: chromium).

- pytest --headed --browser webkit --browser firefox

**--browser-channel** - возможно вам потребуется запускать тесты в браузерах Chrome и Edge, установленных на вашем
компьютере.

- pytest --browser-channel=msedge --headed

**--slowmo** - используется для замедления выполнения теста на указанное количество миллисекунд.
pytest --slowmo 1000

**--device** - можно использовать для имитации поведения браузера для определенного устройства
В качества параметра передайте поддерживаемый девайс. Список поддерживаемых девайсов вы сможете посмотреть по ссылке

- pytest --device="iPhone 13 Mini"

**--output** Каталог для артефактов, создаваемых тестами (по умолчанию: test-results).

**--tracing** Записывать ли трассировку для каждого теста. on, off или retain-on-failure (по умолчанию: off).

**--video** Записывать ли видео для каждого теста. on, off или retain-on-failure (по умолчанию: off).

**--screenshot** Должен ли автоматически делаться снимок экрана после каждого теста.
on, off или only-on-failure (по умолчанию: off).

**--full-page-screenshot** - Следует ли делать скриншот всей страницы при ошибке.
По умолчанию снимается только область просмотра.
Требуется, чтобы параметр --screenshot был включен (по умолчанию: off).

7. Кроме CLI, на выполнение теста можно влиять с помощью декораторов pytest.

``@pytest.mark.only_browser("chromium")``

``@pytest.mark.skip_browser("firefox")``